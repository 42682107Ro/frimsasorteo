<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sorteo FRIMSA S.A.</title>

<style>
:root {
    --verde: #4f6f3a;
    --verde-claro: #7fa866;
    --dorado: #e6c75a;
}

body {
    margin: 0;
    font-family: 'Segoe UI', Arial, sans-serif;
    background: radial-gradient(circle, #0b1208, #000);
    color: white;
    text-align: center;
    overflow-x: hidden;
}

header img {
    max-width: 220px;
    margin-top: 20px;
    animation: fadeDown 1.5s ease-out;
}

h1 {
    font-size: 42px;
    color: var(--verde-claro);
    letter-spacing: 3px;
}

h2 {
    font-weight: 300;
    color: #ccc;
}

main { padding: 20px; }

textarea {
    width: 90%;
    max-width: 800px;
    height: 170px;
    border-radius: 10px;
    border: none;
    padding: 12px;
}

input {
    width: 80px;
    font-size: 18px;
    text-align: center;
    border-radius: 8px;
    border: none;
}

button {
    margin: 10px;
    padding: 15px 35px;
    font-size: 18px;
    border-radius: 50px;
    border: none;
    cursor: pointer;
    font-weight: bold;
}

#btnIniciar { background: var(--verde); color: white; }
#btnSiguiente { background: var(--dorado); color: black; display: none; }
#btnPresentador { background: #333; color: white; }

#panelGanador {
    margin-top: 40px;
    font-size: 42px;
    min-height: 120px;
    color: var(--dorado);
    text-shadow: 0 0 25px rgba(230,199,90,0.9);
}

#cuenta {
    font-size: 80px;
    color: var(--verde-claro);
    animation: pulse 1s infinite;
}

.listaGanadores {
    margin-top: 20px;
    background: rgba(0,0,0,0.6);
    border-radius: 10px;
    padding: 15px;
    max-width: 750px;
    margin-inline: auto;
}

.puesto {
    padding: 6px;
    border-bottom: 1px solid #333;
}

.confetti {
    position: fixed;
    top: 0;
    width: 10px;
    height: 10px;
    animation: fall 3s linear forwards;
}

@keyframes fall {
    to { transform: translateY(100vh) rotate(720deg); opacity: 0; }
}

@keyframes pulse {
    from { transform: scale(1); }
    to { transform: scale(1.3); }
}

@keyframes fadeDown {
    from { opacity: 0; transform: translateY(-40px); }
    to { opacity: 1; transform: translateY(0); }
}
</style>
</head>

<body>

<header>
    <img src="logo-frimsa.png">
    <h1>FRIMSA S.A.</h1>
    <h2>üéâ Sorteo en Vivo üéâ</h2>
</header>

<main>
    <textarea id="nombres" placeholder="Peg√° hasta 90 nombres"></textarea><br><br>

    Ganadores:
    <input type="number" id="cantidad" min="1" max="20" value="20">

    <div>
        <button id="btnIniciar" onclick="iniciar()">üé¨ INICIAR SHOW</button>
        <button id="btnSiguiente" onclick="siguiente()">‚û° SIGUIENTE</button>
        <button id="btnPresentador" onclick="modoPresentador()">üé§ MODO PRESENTADOR</button>
    </div>

    <div id="panelGanador"></div>
    <div class="listaGanadores" id="lista"></div>
</main>

<audio id="redoble" src="redoble.mp3"></audio>
<audio id="aplausos" src="aplausos.mp3"></audio>

<script>
let ganadores = [], indice = 0;

function iniciar() {
    document.documentElement.requestFullscreen?.();

    let nombres = document.getElementById("nombres").value.trim().split("\n").filter(n=>n);
    let cantidad = document.getElementById("cantidad").value;

    if (nombres.length > 90) return alert("M√°x 90 nombres");
    if (cantidad > nombres.length) return alert("No alcanza");

    nombres.sort(()=>Math.random()-0.5);
    ganadores = nombres.slice(0, cantidad);

    document.getElementById("nombres").disabled = true;
    document.getElementById("cantidad").disabled = true;
    document.getElementById("btnSiguiente").style.display = "inline-block";

    document.getElementById("panelGanador").innerHTML = "üé∞ LISTOS...";
}

function siguiente() {
    if (indice >= ganadores.length) {
        document.getElementById("panelGanador").innerHTML = "üéâ FINALIZADO üéâ";
        guardarResultados();
        return;
    }

    let panel = document.getElementById("panelGanador");
    let redoble = document.getElementById("redoble");
    panel.innerHTML = "<div id='cuenta'>3</div>";
    redoble.play();

    let c = 3;
    let intervalo = setInterval(()=>{
        c--;
        if (c === 0) {
            clearInterval(intervalo);
            redoble.pause(); redoble.currentTime = 0;
            mostrarGanador();
        } else {
            document.getElementById("cuenta").innerText = c;
        }
    }, 1000);
}

function mostrarGanador() {
    let nombre = ganadores[indice];
    document.getElementById("panelGanador").innerHTML = `üèÜ Puesto ${indice+1}<br><b>${nombre}</b>`;
    document.getElementById("aplausos").play();

    let div = document.createElement("div");
    div.className = "puesto";
    div.innerText = `Puesto ${indice+1}: ${nombre}`;
    document.getElementById("lista").appendChild(div);

    lanzarConfetti();
    indice++;
}

function lanzarConfetti() {
    for (let i=0;i<80;i++){
        let c = document.createElement("div");
        c.className = "confetti";
        c.style.left = Math.random()*100+"vw";
        c.style.background = ["#7fa866","#e6c75a","#4f6f3a"][Math.floor(Math.random()*3)];
        c.style.animationDuration = (2+Math.random()*2)+"s";
        document.body.appendChild(c);
        setTimeout(()=>c.remove(),3000);
    }
}

function modoPresentador() {
    document.querySelectorAll("textarea,input,button").forEach(e=>e.style.display="none");
}

function guardarResultados() {
    let texto = "RESULTADOS SORTEO FRIMSA S.A.\n\n";
    document.querySelectorAll(".puesto").forEach(p=>texto+=p.innerText+"\n");

    let blob = new Blob([texto], {type:"text/plain"});
    let a = document.createElement("a");
    a.href = URL.createObjectURL(blob);
    a.download = "resultados_sorteo_frimsa.txt";
    a.click();
}
</script>

</body>
</html>
